# æ­£åˆ™è¡¨è¾¾å¼

> æ­£åˆ™è¡¨è¾¾å¼æ˜¯ä¸€ç§ç”¨äºåŒ¹é…å­—ç¬¦ä¸²ä¸­å­—ç¬¦ç»„åˆçš„æ¨¡å¼ï¼Œæ˜¯å‰ç«¯å¼€å‘ä¸­å¸¸ç”¨çš„æ–‡æœ¬å¤„ç†å·¥å…·ã€‚

## åŸºæœ¬æ¦‚å¿µ

æ­£åˆ™è¡¨è¾¾å¼(Regular Expressionï¼Œç®€ç§°RegExp)æ˜¯ç”¨äºåŒ¹é…å­—ç¬¦ä¸²ä¸­å­—ç¬¦ç»„åˆçš„æ¨¡å¼ã€‚åœ¨JavaScriptä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ˜¯å¯¹è±¡ã€‚æ­£åˆ™è¡¨è¾¾å¼é€šè¿‡å°†æ–‡æœ¬ä¸ä¸€ä¸ªæ¨¡å¼åŒ¹é…æ¥å‘æŒ¥ä½œç”¨ï¼Œåœ¨æ–‡æœ¬æœç´¢ã€éªŒè¯ã€æå–å’Œæ›¿æ¢ç­‰åœºæ™¯æœ‰å¹¿æ³›åº”ç”¨ã€‚

### åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼

JavaScriptä¸­åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼æœ‰ä¸¤ç§æ–¹å¼ï¼š

```javascript
/**
 * @description ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å­—é¢é‡åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼
 * @example
 */
const regex1 = /pattern/flags;

/**
 * @description ä½¿ç”¨RegExpæ„é€ å‡½æ•°åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼
 * @example
 */
const regex2 = new RegExp('pattern', 'flags');

// ä½¿ç”¨ç¤ºä¾‹
const patternLiteral = /hello/i;
const patternConstructor = new RegExp('hello', 'i');

// æµ‹è¯•ä¸¤ç§æ–¹å¼
console.log(patternLiteral.test('Hello World'));     // true
console.log(patternConstructor.test('Hello World')); // true

// ä¸¤ç§æ–¹å¼çš„åŒºåˆ«æ¼”ç¤º
const searchTerm = 'user\\w+';  // å‡è®¾è¿™æ˜¯åŠ¨æ€è·å–çš„æœç´¢è¯

// å­—é¢é‡æ–¹å¼éœ€è¦é¢å¤–å¤„ç†è½¬ä¹‰
const badRegex = /searchTerm/;  // è¿™ä¼šåŒ¹é…å­—ç¬¦ä¸² "searchTerm"
console.log(badRegex.test('searchTerm'));      // true
console.log(badRegex.test('user123'));         // false

// æ„é€ å‡½æ•°æ–¹å¼å¯ä»¥ç›´æ¥ä½¿ç”¨å˜é‡
const dynamicRegex = new RegExp(searchTerm);
console.log(dynamicRegex.test('searchTerm'));  // false
console.log(dynamicRegex.test('user123'));     // true

// æ‰§è¡Œç»“æœåˆ†æ:
// å­—é¢é‡æ–¹å¼åœ¨ä»£ç ç¼–è¯‘æ—¶å°±å·²ç¡®å®šï¼Œé€‚åˆå›ºå®šæ¨¡å¼
// æ„é€ å‡½æ•°æ–¹å¼åœ¨è¿è¡Œæ—¶æ„å»ºï¼Œé€‚åˆåŠ¨æ€ç”Ÿæˆçš„æ¨¡å¼
```

### æ­£åˆ™è¡¨è¾¾å¼æ ‡å¿—(flags)

æ ‡å¿—ç”¨äºæ§åˆ¶æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…è¡Œä¸ºã€‚å¸¸ç”¨çš„æ ‡å¿—åŒ…æ‹¬ï¼š

```javascript
/**
 * @description æ­£åˆ™è¡¨è¾¾å¼å¸¸ç”¨æ ‡å¿—ç¤ºä¾‹
 */

// g (global): å…¨å±€åŒ¹é…ï¼ŒæŸ¥æ‰¾æ‰€æœ‰åŒ¹é…é¡¹
const globalRegex = /test/g;
console.log('test1 test2 test3'.match(globalRegex));
// è¾“å‡º: ["test", "test", "test"]

// i (ignoreCase): å¿½ç•¥å¤§å°å†™
const ignoreCaseRegex = /test/i;
console.log('Test'.match(ignoreCaseRegex));
// è¾“å‡º: ["Test"]

// m (multiline): å¤šè¡ŒåŒ¹é…ï¼Œå½±å“ ^ å’Œ $
const multilineRegex = /^test/m;
console.log('line1\ntest line2'.match(multilineRegex));
// è¾“å‡º: ["test"]

// s (dotAll): å…è®¸ . åŒ¹é…æ¢è¡Œç¬¦
const dotAllRegex = /hello.world/s;
console.log('hello\nworld'.match(dotAllRegex));
// è¾“å‡º: ["hello\nworld"]

// u (unicode): ä½¿ç”¨Unicodeç ç‚¹åŒ¹é…
const unicodeRegex = /\u{1F60D}/u;
console.log('ğŸ˜'.match(unicodeRegex));
// è¾“å‡º: ["ğŸ˜"]

// y (sticky): ç²˜æ€§åŒ¹é…ï¼Œä»lastIndexå¼€å§‹åŒ¹é…
const stickyRegex = /test/y;
stickyRegex.lastIndex = 5;
console.log('0123 test'.match(stickyRegex));
// è¾“å‡º: ["test"]

// ç»„åˆä½¿ç”¨å¤šä¸ªæ ‡å¿—
const combinedRegex = /test/gi;
console.log('Test test TEST'.match(combinedRegex));
// è¾“å‡º: ["Test", "test", "TEST"]
```

## æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•

### å­—ç¬¦ç±»

å­—ç¬¦ç±»ç”¨äºåŒ¹é…ä¸€ç»„å­—ç¬¦ä¸­çš„ä»»æ„ä¸€ä¸ªã€‚

```javascript
/**
 * @description æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ç±»ç¤ºä¾‹
 */

// . åŒ¹é…é™¤æ¢è¡Œç¬¦å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦
console.log('a1@'.match(/./g));  // ["a", "1", "@"]

// \d åŒ¹é…ä»»æ„æ•°å­—ï¼Œç­‰ä»·äº[0-9]
console.log('abc123xyz'.match(/\d/g));  // ["1", "2", "3"]

// \D åŒ¹é…ä»»æ„éæ•°å­—ï¼Œç­‰ä»·äº[^0-9]
console.log('abc123xyz'.match(/\D/g));  // ["a", "b", "c", "x", "y", "z"]

// \w åŒ¹é…ä»»æ„å­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿ï¼Œç­‰ä»·äº[A-Za-z0-9_]
console.log('abc_123$xyz'.match(/\w/g));  // ["a", "b", "c", "_", "1", "2", "3", "x", "y", "z"]

// \W åŒ¹é…ä»»æ„éå­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿ï¼Œç­‰ä»·äº[^A-Za-z0-9_]
console.log('abc_123$xyz'.match(/\W/g));  // ["$"]

// \s åŒ¹é…ä»»æ„ç©ºç™½å­—ç¬¦
console.log('a b\tc\nd'.match(/\s/g));  // [" ", "\t", "\n"]

// \S åŒ¹é…ä»»æ„éç©ºç™½å­—ç¬¦
console.log('a b\tc'.match(/\S/g));  // ["a", "b", "c"]

// \b åŒ¹é…å•è¯è¾¹ç•Œ
console.log('word boundary'.match(/\bword\b/g));  // ["word"]

// \B åŒ¹é…éå•è¯è¾¹ç•Œ
console.log('wording'.match(/\Bord\B/g));  // ["ord"]

// æ€§èƒ½æ¯”è¾ƒ
console.time('å­—ç¬¦ç±»');
for (let i = 0; i < 1000000; i++) {
  /\d/.test('123');
}
console.timeEnd('å­—ç¬¦ç±»');

console.time('ç­‰ä»·å­—ç¬¦é›†');
for (let i = 0; i < 1000000; i++) {
  /[0-9]/.test('123');
}
console.timeEnd('ç­‰ä»·å­—ç¬¦é›†');
// é€šå¸¸å­—ç¬¦ç±»(\d)æ¯”ç­‰ä»·å­—ç¬¦é›†([0-9])æ€§èƒ½ç•¥å¥½
```


| è¡¨è¾¾å¼ | æè¿°                                                                     |
| ------ | ------------------------------------------------------------------------ |
| `.`    | åŒ¹é…é™¤æ¢è¡Œç¬¦å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦                                             |
| `\d`   | åŒ¹é…ä»»æ„æ•°å­—ï¼Œç­‰ä»·äº`[0-9]`                                              |
| `\D`   | åŒ¹é…ä»»æ„éæ•°å­—ï¼Œç­‰ä»·äº`[^0-9]`                                           |
| `\w`   | åŒ¹é…ä»»æ„å­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿ï¼Œç­‰ä»·äº`[A-Za-z0-9_]`                         |
| `\W`   | åŒ¹é…ä»»æ„éå­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿ï¼Œç­‰ä»·äº`[^A-Za-z0-9_]`                      |
| `\s`   | åŒ¹é…ä»»æ„ç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰                             |
| `\S`   | åŒ¹é…ä»»æ„éç©ºç™½å­—ç¬¦                                                       |
| `\b`   | åŒ¹é…å•è¯è¾¹ç•ŒÂ  å¼€å¤´ç»“å°¾å’Œç©ºæ ¼,å®ƒæœ¬èº«ä¸åŒ¹é…ä»»ä½•å®é™…å­—ç¬¦ï¼Œä»…è¡¨ç¤ºä¸€ä¸ª"ä½ç½® |
| `\B`   | åŒ¹é…éå•è¯è¾¹ç•Œ                                                           |

### å­—ç¬¦é›†åˆ

å­—ç¬¦é›†åˆæä¾›äº†æ›´çµæ´»çš„å­—ç¬¦åŒ¹é…æ–¹å¼ã€‚

```javascript
/**
 * @description æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦é›†åˆç¤ºä¾‹
 */

// [abc] åŒ¹é…æ–¹æ‹¬å·ä¸­çš„ä»»æ„å­—ç¬¦
console.log('apple banana cherry'.match(/[abc]/g));
// ["a", "a", "a", "a", "c"]

// [^abc] åŒ¹é…é™¤äº†æ–¹æ‹¬å·ä¸­å­—ç¬¦çš„ä»»æ„å­—ç¬¦
console.log('apple banana cherry'.match(/[^abc]/g));
// ["p", "p", "l", "e", " ", "b", "n", "n", " ", "h", "e", "r", "r", "y"]

// [a-z] åŒ¹é…æŒ‡å®šèŒƒå›´å†…çš„ä»»æ„å­—ç¬¦
console.log('a1B2c3'.match(/[a-z]/g));
// ["a", "c"]

// [a-zA-Z0-9] åŒ¹é…å¤šä¸ªèŒƒå›´çš„ä»»æ„å­—ç¬¦
console.log('a1B2c3!@#'.match(/[a-zA-Z0-9]/g));
// ["a", "1", "B", "2", "c", "3"]

// å­—ç¬¦é›†åˆä¸å­—ç¬¦ç±»ç»„åˆä½¿ç”¨
console.log('test123'.match(/[a-z\d]/g));
// ["t", "e", "s", "t", "1", "2", "3"]

// å®é™…åº”ç”¨ï¼šéªŒè¯å¯†ç æ˜¯å¦åŒ…å«ç‰¹æ®Šå­—ç¬¦
function hasSpecialChar(password) {
  return /[^A-Za-z0-9]/.test(password);
}

console.log(hasSpecialChar('abc123'));  // false
console.log(hasSpecialChar('abc123!'));  // true

// ä½¿ç”¨å­—ç¬¦é›†åˆæå–æ–‡æœ¬ä¸­çš„æ‰€æœ‰å…ƒéŸ³å­—æ¯
const text = 'JavaScript is awesome!';
const vowels = text.match(/[aeiou]/gi);
console.log(vowels);  // ["a", "a", "i", "i", "a", "e", "o", "e"]
```


| è¡¨è¾¾å¼        | æè¿°                           |
| ------------- | ------------------------------ |
| `[abc]`       | åŒ¹é…æ–¹æ‹¬å·ä¸­çš„ä»»æ„å­—ç¬¦         |
| `[^abc]`      | åŒ¹é…é™¤äº†æ–¹æ‹¬å·ä¸­å­—ç¬¦çš„ä»»æ„å­—ç¬¦ |
| `[a-z]`       | åŒ¹é…æŒ‡å®šèŒƒå›´å†…çš„ä»»æ„å­—ç¬¦       |
| `[a-zA-Z0-9]` | åŒ¹é…å¤šä¸ªèŒƒå›´çš„ä»»æ„å­—ç¬¦         |

### é‡è¯

é‡è¯ç”¨äºæŒ‡å®šè¡¨è¾¾å¼åŒ¹é…çš„æ¬¡æ•°ã€‚

```javascript
/**
 * @description æ­£åˆ™è¡¨è¾¾å¼é‡è¯ç¤ºä¾‹
 */

// * åŒ¹é…å‰ä¸€ä¸ªè¡¨è¾¾å¼0æ¬¡æˆ–å¤šæ¬¡
console.log('aaa'.match(/a*/g));
// ["aaa", "", "", ""]

// + åŒ¹é…å‰ä¸€ä¸ªè¡¨è¾¾å¼1æ¬¡æˆ–å¤šæ¬¡
console.log('aaa'.match(/a+/g));
// ["aaa"]

// ? åŒ¹é…å‰ä¸€ä¸ªè¡¨è¾¾å¼0æ¬¡æˆ–1æ¬¡
console.log('color colour'.match(/colou?r/g));
// ["color", "colour"]

// {n} ç²¾ç¡®åŒ¹é…å‰ä¸€ä¸ªè¡¨è¾¾å¼næ¬¡
console.log('aaa'.match(/a{2}/g));
// ["aa"]

// {n,} åŒ¹é…å‰ä¸€ä¸ªè¡¨è¾¾å¼è‡³å°‘næ¬¡
console.log('aaa'.match(/a{2,}/g));
// ["aaa"]

// {n,m} åŒ¹é…å‰ä¸€ä¸ªè¡¨è¾¾å¼nåˆ°mæ¬¡
console.log('aaa'.match(/a{1,2}/g));
// ["aa", "a"]

// é‡è¯ä¸å­—ç¬¦ç±»ç»„åˆä½¿ç”¨
const numbers = '42 555 1234 123456';

// åŒ¹é…2-3ä½æ•°å­—
console.log(numbers.match(/\b\d{2,3}\b/g));
// ["42", "555"]

// åŒ¹é…4ä½åŠä»¥ä¸Šæ•°å­—
console.log(numbers.match(/\b\d{4,}\b/g));
// ["1234", "123456"]

// å®é™…åº”ç”¨ï¼šéªŒè¯æ‰‹æœºå·ç ï¼ˆä¸­å›½å¤§é™†ï¼Œ11ä½ï¼‰
function isValidChinesePhone(phone) {
  return /^1[3-9]\d{9}$/.test(phone);
}

console.log(isValidChinesePhone('13812345678'));  // true
console.log(isValidChinesePhone('138123456'));    // false (ä½æ•°ä¸å¤Ÿ)
console.log(isValidChinesePhone('23812345678'));  // false (ä¸æ˜¯1å¼€å¤´)

// é‡è¯æ€§èƒ½æ¯”è¾ƒ
const text = 'a'.repeat(100) + 'b';

console.time('è´ªå©ªåŒ¹é…');
/a+b/.test(text);
console.timeEnd('è´ªå©ªåŒ¹é…');

console.time('æƒ°æ€§åŒ¹é…');
/a+?b/.test(text);
console.timeEnd('æƒ°æ€§åŒ¹é…');
// åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè´ªå©ªåŒ¹é…é€šå¸¸æ¯”æƒ°æ€§åŒ¹é…æ›´å¿«
```


| è¡¨è¾¾å¼  | æè¿°                             |
| ------- | -------------------------------- |
| `*`     | åŒ¹é…å‰ä¸€ä¸ªè¡¨è¾¾å¼0æ¬¡æˆ–å¤šæ¬¡        |
| `+`     | åŒ¹é…å‰ä¸€ä¸ªè¡¨è¾¾å¼1æ¬¡æˆ–å¤šæ¬¡        |
| `?`     | åŒ¹é…å‰ä¸€ä¸ªè¡¨è¾¾å¼0æ¬¡æˆ–1æ¬¡ï¼Œå³å¯é€‰ |
| `{n}`   | ç²¾ç¡®åŒ¹é…å‰ä¸€ä¸ªè¡¨è¾¾å¼næ¬¡          |
| `{n,}`  | åŒ¹é…å‰ä¸€ä¸ªè¡¨è¾¾å¼è‡³å°‘næ¬¡          |
| `{n,m}` | åŒ¹é…å‰ä¸€ä¸ªè¡¨è¾¾å¼nåˆ°mæ¬¡           |

### è¾¹ç•ŒåŒ¹é…

è¾¹ç•ŒåŒ¹é…ç”¨äºæŒ‡å®šåŒ¹é…å‘ç”Ÿçš„ä½ç½®ï¼Œè€Œä¸æ˜¯åŒ¹é…å…·ä½“çš„å­—ç¬¦ã€‚

```javascript
/**
 * @description æ­£åˆ™è¡¨è¾¾å¼è¾¹ç•ŒåŒ¹é…ç¤ºä¾‹
 */

// ^ åŒ¹é…è¾“å…¥çš„å¼€å§‹
console.log('hello world'.match(/^hello/g));  // ["hello"]
console.log('say hello'.match(/^hello/g));    // null

// $ åŒ¹é…è¾“å…¥çš„ç»“æŸ
console.log('world hello'.match(/hello$/g));  // ["hello"]
console.log('hello world'.match(/hello$/g));  // null

// \b åŒ¹é…å•è¯è¾¹ç•Œ
console.log('hello world'.match(/\bhello\b/g));  // ["hello"]
console.log('helloworld'.match(/\bhello\b/g));   // null

// \B åŒ¹é…éå•è¯è¾¹ç•Œ
console.log('helloworld'.match(/\Bworld\b/g));   // ["world"]
console.log('hello world'.match(/\Bworld\b/g));  // null

// å¤šè¡Œæ¨¡å¼ä¸­çš„è¾¹ç•ŒåŒ¹é…
const multilineText = `First line
Second line
Third line`;

// ä¸ä½¿ç”¨å¤šè¡Œæ¨¡å¼ï¼ŒåªåŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²çš„å¼€å§‹
console.log(multilineText.match(/^First/g));  // ["First"]
console.log(multilineText.match(/^Second/g)); // null

// ä½¿ç”¨å¤šè¡Œæ¨¡å¼ï¼ŒåŒ¹é…æ¯ä¸€è¡Œçš„å¼€å§‹
console.log(multilineText.match(/^First/gm));  // ["First"]
console.log(multilineText.match(/^Second/gm)); // ["Second"]

// å®é™…åº”ç”¨ï¼šæå–ä»¥ç‰¹å®šå•è¯å¼€å¤´çš„è¡Œ
function getLinesStartingWith(text, word) {
  const regex = new RegExp(`^${word}.*$`, 'gm');
  return text.match(regex) || [];
}

const logs = `Error: File not found
Info: Process started
Warning: Low memory
Error: Connection timeout`;

console.log(getLinesStartingWith(logs, 'Error'));
// ["Error: File not found", "Error: Connection timeout"]

// è¾¹ç•ŒåŒ¹é…çš„æ€§èƒ½ä¼˜åŒ–
const longText = 'prefix' + 'a'.repeat(10000) + 'suffix';

console.time('æ— è¾¹ç•ŒåŒ¹é…');
/prefix.*suffix/.test(longText);
console.timeEnd('æ— è¾¹ç•ŒåŒ¹é…');

console.time('æœ‰è¾¹ç•ŒåŒ¹é…');
/^prefix.*suffix$/.test(longText);
console.timeEnd('æœ‰è¾¹ç•ŒåŒ¹é…');
// ä½¿ç”¨è¾¹ç•ŒåŒ¹é…é€šå¸¸èƒ½æé«˜æ€§èƒ½ï¼Œå› ä¸ºå¼•æ“å¯ä»¥æ›´å¿«ç¡®å®šåŒ¹é…ä½ç½®
```


| è¡¨è¾¾å¼ | æè¿°           |
| ------ | -------------- |
| `^`    | åŒ¹é…è¾“å…¥çš„å¼€å§‹ |
| `$`    | åŒ¹é…è¾“å…¥çš„ç»“æŸ |
| `\b`   | åŒ¹é…å•è¯è¾¹ç•Œ   |
| `\B`   | åŒ¹é…éå•è¯è¾¹ç•Œ |

### åˆ†ç»„ä¸å¼•ç”¨

åˆ†ç»„å…è®¸å°†æ­£åˆ™è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†è§†ä¸ºå•ä¸ªå•å…ƒï¼Œä¾¿äºåº”ç”¨é‡è¯æˆ–æå–åŒ¹é…å†…å®¹ã€‚

```javascript
/**
 * @description æ­£åˆ™è¡¨è¾¾å¼åˆ†ç»„ä¸å¼•ç”¨ç¤ºä¾‹
 */

// (pattern) æ•è·ç»„
const captureRegex = /(\d{4})-(\d{2})-(\d{2})/;
const dateStr = '2023-05-15';
const dateMatch = dateStr.match(captureRegex);

console.log(dateMatch);
// ["2023-05-15", "2023", "05", "15", index: 0, input: "2023-05-15", groups: undefined]

// é€šè¿‡ç´¢å¼•è®¿é—®æ•è·ç»„
console.log('å¹´ä»½:', dateMatch[1]);  // å¹´ä»½: 2023
console.log('æœˆä»½:', dateMatch[2]);  // æœˆä»½: 05
console.log('æ—¥æœŸ:', dateMatch[3]);  // æ—¥æœŸ: 15

// (?:pattern) éæ•è·ç»„
const nonCaptureRegex = /(?:\d{4})-(\d{2})-(\d{2})/;
const dateMatch2 = dateStr.match(nonCaptureRegex);

console.log(dateMatch2);
// ["2023-05-15", "05", "15", index: 0, input: "2023-05-15", groups: undefined]
// æ³¨æ„ç¬¬ä¸€ä¸ª\d{4}ä¸ä¼šè¢«æ•è·

// \n åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å¼•ç”¨å‰é¢çš„æ•è·ç»„
const repeatWord = /(\w+)\s+\1/;
console.log('hello hello world'.match(repeatWord));
// ["hello hello", "hello", index: 0, input: "hello hello world", groups: undefined]

// åœ¨æ›¿æ¢å­—ç¬¦ä¸²ä¸­å¼•ç”¨æ•è·ç»„
const swapNames = 'John Smith';
const swapped = swapNames.replace(/(\w+)\s+(\w+)/, "$2, $1");
console.log(swapped);  // Smith, John

// (?<name>pattern) å‘½åæ•è·ç»„ (ES2018+)
const namedGroupRegex = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/;
const namedMatch = dateStr.match(namedGroupRegex);

console.log(namedMatch.groups);
// { year: "2023", month: "05", day: "15" }

console.log('å¹´ä»½:', namedMatch.groups.year);   // å¹´ä»½: 2023
console.log('æœˆä»½:', namedMatch.groups.month);  // æœˆä»½: 05
console.log('æ—¥æœŸ:', namedMatch.groups.day);    // æ—¥æœŸ: 15

// åœ¨æ›¿æ¢å­—ç¬¦ä¸²ä¸­å¼•ç”¨å‘½åæ•è·ç»„
const namedSwapped = swapNames.replace(/(?<firstName>\w+)\s+(?<lastName>\w+)/, "$<lastName>, $<firstName>");
console.log(namedSwapped);  // Smith, John

// å®é™…åº”ç”¨ï¼šè§£æURL
function parseURL(url) {
  const urlRegex = /^(?:(?<protocol>\w+):\/\/)?(?<domain>[^\/\s]+)(?<path>\/[^\s]*)?$/;
  const match = url.match(urlRegex);

  if (match && match.groups) {
    return {
      protocol: match.groups.protocol || '',
      domain: match.groups.domain || '',
      path: match.groups.path || ''
    };
  }

  return null;
}

console.log(parseURL('https://www.example.com/path/page.html'));
// { protocol: "https", domain: "www.example.com", path: "/path/page.html" }

// æ€§èƒ½æ¯”è¾ƒï¼šå‘½åæ•è·ç»„ vs ç´¢å¼•æ•è·ç»„
const url = 'https://www.example.com/path/page.html';

console.time('ç´¢å¼•æ•è·ç»„');
for (let i = 0; i < 100000; i++) {
  /^(?:(\w+):\/\/)?([^\/\s]+)(\/[^\s]*)?$/.exec(url);
}
console.timeEnd('ç´¢å¼•æ•è·ç»„');

console.time('å‘½åæ•è·ç»„');
for (let i = 0; i < 100000; i++) {
  /^(?:(?<protocol>\w+):\/\/)?(?<domain>[^\/\s]+)(?<path>\/[^\s]*)?$/.exec(url);
}
console.timeEnd('å‘½åæ•è·ç»„');
// ç´¢å¼•æ•è·ç»„é€šå¸¸æ¯”å‘½åæ•è·ç»„æ€§èƒ½ç•¥å¥½ï¼Œä½†å‘½åæ•è·ç»„å¯è¯»æ€§æ›´å¼º
```


| è¡¨è¾¾å¼             | æè¿°                                               |
| ------------------ | -------------------------------------------------- |
| `(pattern)`        | æ•è·ç»„ï¼ŒåŒ¹é…æ‹¬å·å†…çš„è¡¨è¾¾å¼å¹¶å°†å…¶ä½œä¸ºä¸€ä¸ªç»„         |
| `(?:pattern)`      | éæ•è·ç»„ï¼ŒåŒ¹é…æ‹¬å·å†…çš„è¡¨è¾¾å¼ä½†ä¸è®°ä½åŒ¹é…é¡¹         |
| `\n`               | åœ¨æ­£åˆ™è¡¨è¾¾å¼æˆ–æ›¿æ¢å­—ç¬¦ä¸²ä¸­ï¼Œè¡¨ç¤ºç¬¬nä¸ªæ•è·ç»„        |
| `(?<name>pattern)` | å‘½åæ•è·ç»„ï¼ŒåŒ¹é…æ‹¬å·å†…çš„è¡¨è¾¾å¼å¹¶å°†å…¶ä½œä¸ºä¸€ä¸ªå…·åç»„ |

### è´ªå©ªä¸æƒ°æ€§åŒ¹é…

é»˜è®¤æƒ…å†µä¸‹ï¼Œé‡è¯æ˜¯è´ªå©ªçš„ï¼Œå³å°½å¯èƒ½å¤šåœ°åŒ¹é…å­—ç¬¦ã€‚æƒ°æ€§åŒ¹é…åˆ™å°½å¯èƒ½å°‘åœ°åŒ¹é…å­—ç¬¦ã€‚

```javascript
/**
 * @description æ­£åˆ™è¡¨è¾¾å¼è´ªå©ªä¸æƒ°æ€§åŒ¹é…ç¤ºä¾‹
 */

// è´ªå©ªåŒ¹é…ç¤ºä¾‹
const greedyRegex = /<.+>/;
const htmlStr = '<div>Hello</div>';
console.log(htmlStr.match(greedyRegex));
// ["<div>Hello</div>", index: 0, input: "<div>Hello</div>", groups: undefined]
// è´ªå©ªåŒ¹é…ä¼šåŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å†…å®¹ï¼Œç›´åˆ°æœ€åä¸€ä¸ª>

// æƒ°æ€§åŒ¹é…ç¤ºä¾‹
const lazyRegex = /<.+?>/;
console.log(htmlStr.match(lazyRegex));
// ["<div>", index: 0, input: "<div>Hello</div>", groups: undefined]
// æƒ°æ€§åŒ¹é…ä¼šåœ¨é‡åˆ°ç¬¬ä¸€ä¸ª>æ—¶åœæ­¢

// ä¸åŒé‡è¯çš„è´ªå©ªä¸æƒ°æ€§å¯¹æ¯”
const text = 'aaa';

console.log('* è´ªå©ª:', text.match(/a*/));    // ["aaa", index: 0, input: "aaa", groups: undefined]
console.log('* æƒ°æ€§:', text.match(/a*?/));    // ["", index: 0, input: "aaa", groups: undefined]

console.log('+ è´ªå©ª:', text.match(/a+/));    // ["aaa", index: 0, input: "aaa", groups: undefined]
console.log('+ æƒ°æ€§:', text.match(/a+?/));    // ["a", index: 0, input: "aaa", groups: undefined]

console.log('? è´ªå©ª:', text.match(/a?/));    // ["a", index: 0, input: "aaa", groups: undefined]
console.log('? æƒ°æ€§:', text.match(/a??/));    // ["", index: 0, input: "aaa", groups: undefined]

// è´ªå©ªåŒ¹é…å…¨å±€æ¨¡å¼
console.log('å…¨å±€è´ªå©ª:', text.match(/a*/g));  // ["aaa", "", ""]
console.log('å…¨å±€æƒ°æ€§:', text.match(/a*?/g)); // ["", "", "", ""]

// å®é™…åº”ç”¨ï¼šæå–HTMLæ ‡ç­¾
function extractHtmlTags(html) {
  // è´ªå©ªåŒ¹é…ä¼šå¯¼è‡´é”™è¯¯çš„ç»“æœ
  const greedyTags = html.match(/<.+>/g);

  // æƒ°æ€§åŒ¹é…èƒ½å¤Ÿæ­£ç¡®æå–æ¯ä¸ªæ ‡ç­¾
  const lazyTags = html.match(/<.+?>/g);

  return {
    greedy: greedyTags,
    lazy: lazyTags
  };
}

const complexHtml = '<div><p>Paragraph</p><span>Text</span></div>';
const extractedTags = extractHtmlTags(complexHtml);

console.log('è´ªå©ªåŒ¹é…ç»“æœ:', extractedTags.greedy);
// ["<div><p>Paragraph</p><span>Text</span></div>"]

console.log('æƒ°æ€§åŒ¹é…ç»“æœ:', extractedTags.lazy);
// ["<div>", "<p>", "</p>", "<span>", "</span>", "</div>"]

// æ€§èƒ½æ¯”è¾ƒ
const longHtml = '<div>' + 'a'.repeat(10000) + '</div>';

console.time('è´ªå©ªåŒ¹é…');
/<.+>/.test(longHtml);
console.timeEnd('è´ªå©ªåŒ¹é…');

console.time('æƒ°æ€§åŒ¹é…');
/<.+?>/.test(longHtml);
console.timeEnd('æƒ°æ€§åŒ¹é…');
// åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæƒ°æ€§åŒ¹é…å¯èƒ½æ¯”è´ªå©ªåŒ¹é…æ€§èƒ½æ›´å¥½ï¼Œå°¤å…¶æ˜¯å¤„ç†å¤§æ–‡æœ¬æ—¶
```

### å›æº¯æœºåˆ¶ï¼ˆBacktrackingï¼‰

å›æº¯æ˜¯æ­£åˆ™è¡¨è¾¾å¼å¼•æ“åœ¨åŒ¹é…è¿‡ç¨‹ä¸­çš„ä¸€ç§é‡è¦æœºåˆ¶ï¼Œå®ƒå…è®¸å¼•æ“åœ¨åŒ¹é…å¤±è´¥æ—¶è¿”å›åˆ°ä¹‹å‰çš„çŠ¶æ€ï¼Œå°è¯•å…¶ä»–å¯èƒ½çš„åŒ¹é…è·¯å¾„ã€‚ç†è§£å›æº¯å¯¹äºç¼–å†™é«˜æ•ˆçš„æ­£åˆ™è¡¨è¾¾å¼å’Œé¿å…æ€§èƒ½é—®é¢˜è‡³å…³é‡è¦ã€‚

```javascript
/**
 * @description æ­£åˆ™è¡¨è¾¾å¼å›æº¯æœºåˆ¶ç¤ºä¾‹
 */

// åŸºæœ¬å›æº¯ç¤ºä¾‹
const regex = /a+b/;
const str = 'aaab';

// åŒ¹é…è¿‡ç¨‹ï¼š
// 1. 'a+' è´ªå©ªåŒ¹é…æ‰€æœ‰ 'a'ï¼Œå³ 'aaa'
// 2. å°è¯•åŒ¹é… 'b'ï¼Œä½†å½“å‰ä½ç½®å·²ç»åˆ°è¾¾å­—ç¬¦ä¸²æœ«å°¾
// 3. å›æº¯ï¼šæ”¾å¼ƒä¸€ä¸ª 'a' çš„åŒ¹é…ï¼Œå˜æˆ 'aa'
// 4. å†æ¬¡å°è¯•åŒ¹é… 'b'ï¼ŒæˆåŠŸåŒ¹é…
// æœ€ç»ˆç»“æœï¼š'aaab'

console.log(str.match(regex));
// ["aaab", index: 0, input: "aaab", groups: undefined]

// å›æº¯ä¸è´ªå©ªé‡è¯
const greedyRegex = /.*foo/;
const greedyStr = 'xfooxxxxxxfoo';

// åŒ¹é…è¿‡ç¨‹ï¼š
// 1. '.*' è´ªå©ªåŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸² 'xfooxxxxxxfoo'
// 2. å°è¯•åŒ¹é… 'foo'ï¼Œä½†å·²åˆ°è¾¾å­—ç¬¦ä¸²æœ«å°¾
// 3. å›æº¯ï¼šé€ä¸ªæ”¾å¼ƒå­—ç¬¦ï¼Œç›´åˆ°èƒ½åŒ¹é… 'foo'
// 4. æœ€ç»ˆåŒ¹é… 'xfooxxxxxx' + 'foo'

console.log(greedyStr.match(greedyRegex));
// ["xfooxxxxxxfoo", index: 0, input: "xfooxxxxxxfoo", groups: undefined]

// å›æº¯ä¸æƒ°æ€§é‡è¯
const lazyRegex = /.*?foo/g;
console.log(greedyStr.match(lazyRegex));
// ["xfoo", "xxxxxxfoo"]
// æƒ°æ€§é‡è¯å‡å°‘äº†å›æº¯æ¬¡æ•°

/**
 * @description ç¾éš¾æ€§å›æº¯ï¼ˆCatastrophic Backtrackingï¼‰
 */

// ç¾éš¾æ€§å›æº¯ç¤ºä¾‹
function testCatastrophicBacktracking() {
  // æœ‰é£é™©çš„æ­£åˆ™è¡¨è¾¾å¼
  const riskyRegex = /(a+)+b/;

  // æ„é€ ä¸€ä¸ªä¼šå¯¼è‡´å¤§é‡å›æº¯çš„å­—ç¬¦ä¸²
  const input = 'a'.repeat(30) + 'c'; // ä¸ä»¥'b'ç»“å°¾ï¼Œå¯¼è‡´åŒ¹é…å¤±è´¥

  console.log('å¼€å§‹æµ‹è¯•ç¾éš¾æ€§å›æº¯...');
  console.time('ç¾éš¾æ€§å›æº¯æµ‹è¯•');

  try {
    // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™å¯èƒ½å¯¼è‡´æµè§ˆå™¨æŒ‚èµ·
    const result = riskyRegex.test(input);
    console.log('åŒ¹é…ç»“æœ:', result);
  } catch (e) {
    console.log('æ‰§è¡Œè¢«ä¸­æ–­:', e.message);
  }

  console.timeEnd('ç¾éš¾æ€§å›æº¯æµ‹è¯•');
  // åœ¨æŸäº›ç¯å¢ƒä¸­ï¼Œè¿™ä¸ªæ“ä½œå¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½å®Œæˆ
  // æˆ–è€…å¯¼è‡´è¶…æ—¶é”™è¯¯
}

// æ³¨æ„ï¼šå–æ¶ˆä¸‹é¢çš„æ³¨é‡Šå¯èƒ½å¯¼è‡´æµè§ˆå™¨æŒ‚èµ·
// testCatastrophicBacktracking();

/**
 * @description é¿å…ç¾éš¾æ€§å›æº¯çš„ç­–ç•¥
 */
class BacktrackingOptimizer {
  /**
   * ä¼˜åŒ–æ­£åˆ™è¡¨è¾¾å¼ä»¥å‡å°‘å›æº¯
   */
  static optimizeRegex(regex, description) {
    // åˆ†ææ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼
    const pattern = regex.toString().slice(1, -1); // ç§»é™¤æ–œæ 
    const flags = regex.flags;

    // æ£€æµ‹å¸¸è§çš„å›æº¯é—®é¢˜
    const issues = [];

    // æ£€æŸ¥åµŒå¥—é‡å¤
    if (/(\(.+\+\)\+|\(.+\*\)\+|\(.+\+\)\*)/.test(pattern)) {
      issues.push('åµŒå¥—é‡å¤ï¼ˆå¦‚(a+)+ï¼‰å¯èƒ½å¯¼è‡´ç¾éš¾æ€§å›æº¯');
    }

    // æ£€æŸ¥ç›¸é‚»çš„é‡å¤é‡è¯
    if (/\+\+|\*\+|\+\*|\*\*/.test(pattern)) {
      issues.push('ç›¸é‚»é‡å¤é‡è¯å¯èƒ½å¯¼è‡´ä¸å¿…è¦çš„å›æº¯');
    }

    // æ£€æŸ¥å¯èƒ½çš„ä¼˜åŒ–æœºä¼š
    const optimizations = [];

    // å»ºè®®ä½¿ç”¨åŸå­ç»„
    if (/(\(.+\))/.test(pattern) && !/(\?\>)/.test(pattern)) {
      optimizations.push('è€ƒè™‘ä½¿ç”¨åŸå­ç»„(?>..)æ¥é˜²æ­¢å›æº¯');
    }

    // å»ºè®®ä½¿ç”¨å æœ‰é‡è¯ï¼ˆES2018ä¸æ”¯æŒï¼Œä½†æ¦‚å¿µä¸Šæœ‰ç”¨ï¼‰
    if (/\+|\*/.test(pattern) && !/(\?\+)/.test(pattern)) {
      optimizations.push('è€ƒè™‘ä½¿ç”¨å æœ‰é‡è¯(å¦‚a++ï¼ŒESä¸æ”¯æŒä½†å¯ç”¨å…¶ä»–æ–¹å¼æ¨¡æ‹Ÿ)');
    }

    // å»ºè®®ä½¿ç”¨æ›´å…·ä½“çš„å­—ç¬¦ç±»
    if (/\.\+|\.\*/.test(pattern)) {
      optimizations.push('ç”¨æ›´å…·ä½“çš„å­—ç¬¦ç±»æ›¿æ¢.+æˆ–.*å¯å‡å°‘å›æº¯');
    }

    return {
      original: {
        pattern: pattern,
        flags: flags,
        regex: regex
      },
      issues: issues,
      optimizations: optimizations,
      description: description
    };
  }

  /**
   * æµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼æ€§èƒ½
   */
  static testPerformance(regex, input, iterations = 1) {
    console.time('æ­£åˆ™æ€§èƒ½æµ‹è¯•');

    let result;
    for (let i = 0; i < iterations; i++) {
      result = regex.test(input);
    }

    console.timeEnd('æ­£åˆ™æ€§èƒ½æµ‹è¯•');
    return result;
  }

  /**
   * æä¾›ä¼˜åŒ–åçš„æ­£åˆ™è¡¨è¾¾å¼
   */
  static getOptimizedVersion(regex) {
    const pattern = regex.toString().slice(1, -1);
    const flags = regex.flags;

    // ä¸€äº›åŸºæœ¬çš„ä¼˜åŒ–è½¬æ¢
    let optimized = pattern
      // å°†åµŒå¥—é‡å¤è½¬æ¢ä¸ºéæ•è·ç»„å’Œé™å®šèŒƒå›´
      .replace(/(\(.+\)\+)\+/g, '(?:$1{1,1000})')
      // å°†.+æ›¿æ¢ä¸ºæ›´å…·ä½“çš„æ¨¡å¼ï¼ˆç¤ºä¾‹ï¼‰
      .replace(/\.\+/g, '[^\\n]+')
      // æ·»åŠ åŸå­ç»„ï¼ˆå¦‚æœç¯å¢ƒæ”¯æŒï¼‰
      .replace(/\(([^?].*?)\)/g, '(?:$1)');

    return {
      pattern: optimized,
      regex: new RegExp(optimized, flags),
      original: regex
    };
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const problematicRegex = /(a+)+b/;
const analysis = BacktrackingOptimizer.optimizeRegex(problematicRegex, 'åµŒå¥—é‡å¤ç¤ºä¾‹');

console.log('æ­£åˆ™è¡¨è¾¾å¼åˆ†æ:', analysis);
// è¾“å‡ºåˆ†æç»“æœï¼ŒåŒ…æ‹¬æ½œåœ¨é—®é¢˜å’Œä¼˜åŒ–å»ºè®®

// ä¼˜åŒ–ç‰ˆæœ¬
const optimized = BacktrackingOptimizer.getOptimizedVersion(problematicRegex);
console.log('ä¼˜åŒ–åçš„æ­£åˆ™:', optimized.pattern);

// æ€§èƒ½å¯¹æ¯”ï¼ˆä½¿ç”¨å®‰å…¨çš„è¾“å…¥ï¼‰
const safeInput = 'aaaab';
console.log('åŸå§‹æ­£åˆ™æ€§èƒ½:');
BacktrackingOptimizer.testPerformance(problematicRegex, safeInput);

console.log('ä¼˜åŒ–æ­£åˆ™æ€§èƒ½:');
BacktrackingOptimizer.testPerformance(optimized.regex, safeInput);
```

å›æº¯æœºåˆ¶æ˜¯æ­£åˆ™è¡¨è¾¾å¼å¼•æ“åœ¨åŒ¹é…è¿‡ç¨‹ä¸­çš„æ ¸å¿ƒæœºåˆ¶ï¼Œä½†ä¹Ÿæ˜¯æ€§èƒ½é—®é¢˜çš„ä¸»è¦æ¥æºã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å…³äºå›æº¯çš„é‡è¦æ¦‚å¿µï¼š

| æ¦‚å¿µ | æè¿° |
| --- | --- |
| å›æº¯ | æ­£åˆ™å¼•æ“åœ¨åŒ¹é…å¤±è´¥æ—¶ï¼Œè¿”å›åˆ°ä¹‹å‰çš„çŠ¶æ€ï¼Œå°è¯•å…¶ä»–å¯èƒ½çš„åŒ¹é…è·¯å¾„ |
| è´ªå©ªé‡è¯å›æº¯ | è´ªå©ªé‡è¯(`+`, `*`, `{n,m}`)ä¼šå…ˆå°è¯•åŒ¹é…æœ€å¤šï¼Œç„¶ååœ¨éœ€è¦æ—¶å›æº¯ |
| æƒ°æ€§é‡è¯å›æº¯ | æƒ°æ€§é‡è¯(`+?`, `*?`, `{n,m}?`)ä¼šå…ˆå°è¯•åŒ¹é…æœ€å°‘ï¼Œå‡å°‘å›æº¯æ¬¡æ•° |
| ç¾éš¾æ€§å›æº¯ | åœ¨æŸäº›æ¨¡å¼ä¸‹(å¦‚åµŒå¥—é‡å¤`(a+)+`)ï¼Œå›æº¯æ¬¡æ•°å¯èƒ½å‘ˆæŒ‡æ•°çº§å¢é•¿ï¼Œå¯¼è‡´æ€§èƒ½å´©æºƒ |
| åŸå­ç»„ | ä½¿ç”¨`(?>...)`åˆ›å»ºä¸å‚ä¸å›æº¯çš„ç»„ï¼Œä¸€æ—¦åŒ¹é…æˆåŠŸå°±ä¸å†æ”¹å˜ |
| å æœ‰é‡è¯ | ç±»ä¼¼`a++`çš„æ¨¡å¼(JavaScriptä¸ç›´æ¥æ”¯æŒ)ï¼ŒåŒ¹é…å°½å¯èƒ½å¤šä½†ä¸å›æº¯ |

### å‰ç»ä¸åé¡¾

å‰ç»å’Œåé¡¾æ–­è¨€ç”¨äºåŒ¹é…æ»¡è¶³ç‰¹å®šæ¡ä»¶ä½†åˆä¸æ¶ˆè€—å­—ç¬¦çš„æ¨¡å¼ã€‚

```javascript
/**
 * @description æ­£åˆ™è¡¨è¾¾å¼å‰ç»ä¸åé¡¾ç¤ºä¾‹
 */

// X(?=Y) å‰ç»(lookahead)ï¼ŒåŒ¹é…Xä»…å½“Xåé¢è·Ÿç€Y
const positiveAhead = /\d+(?=px)/g;
console.log('10px 20em 30px'.match(positiveAhead));
// ["10", "30"]  åŒ¹é…æ•°å­—ï¼Œä½†åªæœ‰å½“åé¢è·Ÿç€"px"æ—¶

// X(?!Y) è´Ÿå‰ç»(negative lookahead)ï¼ŒåŒ¹é…Xä»…å½“Xåé¢ä¸è·ŸY
const negativeAhead = /\d+(?!px)/g;
console.log('10px 20em 30px'.match(negativeAhead));
// ["20"]  åŒ¹é…æ•°å­—ï¼Œä½†åªæœ‰å½“åé¢ä¸è·Ÿç€"px"æ—¶

// (?<=Y)X åé¡¾(lookbehind)ï¼ŒåŒ¹é…Xä»…å½“Xå‰é¢æ˜¯Y (ES2018+)
const positiveBehind = /(?<=\$)\d+/g;
console.log('$10 â‚¬20 $30'.match(positiveBehind));
// ["10", "30"]  åŒ¹é…æ•°å­—ï¼Œä½†åªæœ‰å½“å‰é¢æ˜¯"$"æ—¶

// (?<!Y)X è´Ÿåé¡¾(negative lookbehind)ï¼ŒåŒ¹é…Xä»…å½“Xå‰é¢ä¸æ˜¯Y (ES2018+)
const negativeBehind = /(?<!\$)\d+/g;
console.log('$10 â‚¬20 $30'.match(negativeBehind));
// ["20"]  åŒ¹é…æ•°å­—ï¼Œä½†åªæœ‰å½“å‰é¢ä¸æ˜¯"$"æ—¶

// ç»„åˆä½¿ç”¨å‰ç»å’Œåé¡¾
const combined = /(?<=\$)(\d+)(?=\.\d{2})/g;
console.log('$10.99 $20.50 â‚¬30.25'.match(combined));
// ["10", "20"]  åŒ¹é…ç¾å…ƒé‡‘é¢çš„æ•´æ•°éƒ¨åˆ†

// å®é™…åº”ç”¨ï¼šå¯†ç å¼ºåº¦æ£€æŸ¥
function checkPasswordStrength(password) {
  const hasLowerCase = /[a-z]/.test(password);
  const hasUpperCase = /[A-Z]/.test(password);
  const hasDigit = /\d/.test(password);
  const hasSpecialChar = /[^\w\s]/.test(password);

  // ä½¿ç”¨å‰ç»æ–­è¨€æ£€æŸ¥æ˜¯å¦åŒ…å«è‡³å°‘ä¸€ä¸ªæ•°å­—åé¢ä¸è·Ÿå­—æ¯
  const hasDigitNotFollowedByLetter = /\d(?![a-zA-Z])/.test(password);

  // ä½¿ç”¨åé¡¾æ–­è¨€æ£€æŸ¥æ˜¯å¦åŒ…å«å¤§å†™å­—æ¯å‰é¢æœ‰å°å†™å­—æ¯
  const hasUpperAfterLower = /(?<=[a-z])[A-Z]/.test(password);

  return {
    hasLowerCase,
    hasUpperCase,
    hasDigit,
    hasSpecialChar,
    hasDigitNotFollowedByLetter,
    hasUpperAfterLower,
    strength: hasLowerCase + hasUpperCase + hasDigit + hasSpecialChar
  };
}

console.log(checkPasswordStrength('Passw0rd!'));
/* è¾“å‡º:
{
  hasLowerCase: true,
  hasUpperCase: true,
  hasDigit: true,
  hasSpecialChar: true,
  hasDigitNotFollowedByLetter: false,
  hasUpperAfterLower: true,
  strength: 4
}
*/

// æ€§èƒ½è€ƒè™‘ï¼šæ–­è¨€é€šå¸¸æ¯”æ•è·ç»„æ›´é«˜æ•ˆ
const text = 'abc123def';

console.time('ä½¿ç”¨æ•è·ç»„');
for (let i = 0; i < 100000; i++) {
  const match = text.match(/([a-z]+)(\d+)/);
  const letters = match[1];
  const numbers = match[2];
}
console.timeEnd('ä½¿ç”¨æ•è·ç»„');

console.time('ä½¿ç”¨å‰ç»æ–­è¨€');
for (let i = 0; i < 100000; i++) {
  const letters = text.match(/[a-z]+(?=\d+)/)[0];
  const numbers = text.match(/(?<=[a-z]+)\d+/)[0];
}
console.timeEnd('ä½¿ç”¨å‰ç»æ–­è¨€');
// åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œä½¿ç”¨æ–­è¨€å¯èƒ½ä¼šæœ‰æ€§èƒ½ä¼˜åŠ¿
```


| è¡¨è¾¾å¼    | æè¿°                                             |
| --------- | ------------------------------------------------ |
| `X(?=Y)`  | å‰ç»(lookahead)ï¼ŒåŒ¹é…Xä»…å½“Xåé¢è·Ÿç€Y             |
| `X(?!Y)`  | è´Ÿå‰ç»(negative lookahead)ï¼ŒåŒ¹é…Xä»…å½“Xåé¢ä¸è·ŸY  |
| `(?<=Y)X` | åé¡¾(lookbehind)ï¼ŒåŒ¹é…Xä»…å½“Xå‰é¢æ˜¯Y              |
| `(?<!Y)X` | è´Ÿåé¡¾(negative lookbehind)ï¼ŒåŒ¹é…Xä»…å½“Xå‰é¢ä¸æ˜¯Y |

### å›æº¯å¼•ç”¨ï¼ˆBackreferencesï¼‰

å›æº¯å¼•ç”¨å…è®¸åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å¼•ç”¨å‰é¢å·²ç»åŒ¹é…çš„æ•è·ç»„ï¼Œè¿™æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„å¼ºå¤§åŠŸèƒ½ä¹‹ä¸€ã€‚

```javascript
/**
 * @description å›æº¯å¼•ç”¨çš„åŸºæœ¬ä½¿ç”¨
 */

// \1, \2, \3... å¼•ç”¨å¯¹åº”ç¼–å·çš„æ•è·ç»„
// åŸºæœ¬å›æº¯å¼•ç”¨ç¤ºä¾‹
const duplicateWordRegex = /(\w+)\s+\1/;
console.log('hello hello world'.match(duplicateWordRegex));
// ["hello hello", "hello"] - åŒ¹é…é‡å¤çš„å•è¯

console.log('test test'.match(duplicateWordRegex));
// ["test test", "test"]

console.log('hello world'.match(duplicateWordRegex));
// null - ä¸åŒ¹é…ï¼Œå› ä¸ºå•è¯ä¸é‡å¤

// æ›´å¤æ‚çš„å›æº¯å¼•ç”¨
const htmlTagRegex = /<(\w+).*?>(.*?)<\/\1>/;
console.log('<div>content</div>'.match(htmlTagRegex));
// ["<div>content</div>", "div", "content"] - åŒ¹é…æˆå¯¹çš„HTMLæ ‡ç­¾

console.log('<p>paragraph</p>'.match(htmlTagRegex));
// ["<p>paragraph</p>", "p", "paragraph"]

console.log('<div>content</span>'.match(htmlTagRegex));
// null - ä¸åŒ¹é…ï¼Œå› ä¸ºå¼€å§‹å’Œç»“æŸæ ‡ç­¾ä¸ä¸€è‡´

// å¤šé‡å›æº¯å¼•ç”¨
const cssPropertyRegex = /(\w+):\s*([^;]+);\s*\1:\s*\2/;
console.log('color: red; color: red'.match(cssPropertyRegex));
// ["color: red; color: red", "color", "red"] - åŒ¹é…é‡å¤çš„CSSå±æ€§

/**
 * @description å›æº¯å¼•ç”¨çš„å®é™…åº”ç”¨ - æŸ¥æ‰¾é‡å¤å†…å®¹
 */
class DuplicateContentDetector {
  /**
   * æ£€æµ‹æ–‡æœ¬ä¸­çš„é‡å¤å•è¯
   */
  static findDuplicateWords(text) {
    const regex = /\b(\w+)\s+\1\b/gi;
    const matches = [];
    let match;

    while ((match = regex.exec(text)) !== null) {
      matches.push({
        word: match[1],
        position: match.index,
        fullMatch: match[0]
      });
    }

    return matches;
  }

  /**
   * æ£€æµ‹é‡å¤çš„å¥å­æ¨¡å¼
   */
  static findDuplicateSentences(text) {
    const regex = /([^.!?]+[.!?])\s*\1/gi;
    const matches = [];
    let match;

    while ((match = regex.exec(text)) !== null) {
      matches.push({
        sentence: match[1].trim(),
        position: match.index,
        fullMatch: match[0]
      });
    }

    return matches;
  }

  /**
   * æ£€æµ‹HTMLä¸­ä¸åŒ¹é…çš„æ ‡ç­¾
   */
  static findMismatchedTags(html) {
    const validTags = /<(\w+)(?:[^>]*)>([\s\S]*?)<\/\1>/g;
    const allTags = /<\/?(\w+)(?:[^>]*)>/g;

    const matched = [];
    const unmatched = [];

    // æ‰¾å‡ºæ­£ç¡®åŒ¹é…çš„æ ‡ç­¾
    let match;
    while ((match = validTags.exec(html)) !== null) {
      matched.push({
        tag: match[1],
        content: match[2],
        fullMatch: match[0]
      });
    }

    // é‡ç½®regex
    allTags.lastIndex = 0;

    // æ‰¾å‡ºæ‰€æœ‰æ ‡ç­¾
    const allTagsList = [];
    while ((match = allTags.exec(html)) !== null) {
      allTagsList.push({
        tag: match[1],
        position: match.index,
        fullMatch: match[0],
        isClosing: match[0].startsWith('</')
      });
    }

    return {
      matched: matched,
      total: allTagsList.length,
      matchedCount: matched.length * 2 // æ¯ä¸ªåŒ¹é…åŒ…å«å¼€å§‹å’Œç»“æŸæ ‡ç­¾
    };
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const text = "This is is a test test sentence. Another another example.";
console.log('é‡å¤å•è¯æ£€æµ‹:', DuplicateContentDetector.findDuplicateWords(text));
// [
//   { word: 'is', position: 5, fullMatch: 'is is' },
//   { word: 'test', position: 13, fullMatch: 'test test' },
//   { word: 'another', position: 38, fullMatch: 'another another' }
// ]

const htmlContent = '<div><p>Content</p><span>Text</div><article>Invalid</span>';
console.log('HTMLæ ‡ç­¾æ£€æµ‹:', DuplicateContentDetector.findMismatchedTags(htmlContent));

/**
 * @description é«˜çº§å›æº¯å¼•ç”¨åº”ç”¨ - æ–‡æœ¬æ›¿æ¢å’Œé‡æ„
 */
class TextReplacer {
  /**
   * ä½¿ç”¨å›æº¯å¼•ç”¨äº¤æ¢å•è¯é¡ºåº
   */
  static swapWords(text) {
    return text.replace(/(\w+)\s+(\w+)/g, '$2 $1');
  }

  /**
   * æ ¼å¼åŒ–æ—¥æœŸï¼ˆMM/DD/YYYY è½¬ YYYY-MM-DDï¼‰
   */
  static formatDate(text) {
    return text.replace(/(\d{1,2})\/(\d{1,2})\/(\d{4})/g, '$3-$1-$2');
  }

  /**
   * ä¿®å¤HTMLæ ‡ç­¾çš„å¤§å°å†™
   */
  static fixHtmlTagCase(html) {
    return html.replace(/<(\/?)([\w]+)(.*?)>/gi, (match, slash, tagName, attributes) => {
      return `<${slash}${tagName.toLowerCase()}${attributes}>`;
    });
  }

  /**
   * å°†é©¼å³°å‘½åè½¬æ¢ä¸ºçŸ­æ¨ªçº¿å‘½å
   */
  static camelToKebab(text) {
    return text.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();
  }

  /**
   * æå–å¹¶é‡ç»„ç”µè¯å·ç æ ¼å¼
   */
  static formatPhoneNumber(text) {
    // åŒ¹é…å„ç§ç”µè¯å·ç æ ¼å¼
    return text.replace(
      /(\d{3})[-.\s]?(\d{3})[-.\s]?(\d{4})/g,
      '($1) $2-$3'
    );
  }
}

// ä½¿ç”¨ç¤ºä¾‹
console.log('å•è¯äº¤æ¢:', TextReplacer.swapWords('hello world test case'));
// "world hello case test"

console.log('æ—¥æœŸæ ¼å¼åŒ–:', TextReplacer.formatDate('ä»Šå¤©æ˜¯ 12/25/2023ï¼Œæ˜å¤©æ˜¯ 01/01/2024'));
// "ä»Šå¤©æ˜¯ 2023-12-25ï¼Œæ˜å¤©æ˜¯ 2024-01-01"

console.log('HTMLæ ‡ç­¾ä¿®å¤:', TextReplacer.fixHtmlTagCase('<DIV><P>Text</P></DIV>'));
// "<div><p>Text</p></div>"

console.log('é©¼å³°è½¬çŸ­æ¨ªçº¿:', TextReplacer.camelToKebab('firstName lastName userName'));
// "first-name last-name user-name"

console.log('ç”µè¯å·ç æ ¼å¼åŒ–:', TextReplacer.formatPhoneNumber('è”ç³»ç”µè¯: 123-456-7890 æˆ– 987.654.3210'));
// "è”ç³»ç”µè¯: (123) 456-7890 æˆ– (987) 654-3210"

/**
 * @description å‘½åæ•è·ç»„çš„å›æº¯å¼•ç”¨ï¼ˆES2018+ï¼‰
 */
class NamedBackreferences {
  /**
   * ä½¿ç”¨å‘½åæ•è·ç»„å¤„ç†å¤æ‚æ¨¡å¼
   */
  static processComplexPattern(text) {
    // ä½¿ç”¨å‘½åæ•è·ç»„
    const regex = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/g;
    const dates = [];
    let match;

    while ((match = regex.exec(text)) !== null) {
      dates.push({
        original: match[0],
        year: match.groups.year,
        month: match.groups.month,
        day: match.groups.day,
        formatted: `${match.groups.month}/${match.groups.day}/${match.groups.year}`
      });
    }

    return dates;
  }

  /**
   * ä½¿ç”¨å‘½åå›æº¯å¼•ç”¨éªŒè¯é‡å¤æ¨¡å¼
   */
  static validateRepeatedPattern(text) {
    // éªŒè¯æ ¼å¼ä¸º "word:word" çš„æ¨¡å¼ï¼ˆä¸¤ä¸ªwordå¿…é¡»ç›¸åŒï¼‰
    const regex = /(?<word>\w+):(?<same>\k<word>)/g;
    const matches = [];
    let match;

    while ((match = regex.exec(text)) !== null) {
      matches.push({
        word: match.groups.word,
        position: match.index,
        isValid: true
      });
    }

    return matches;
  }

  /**
   * è§£æé…ç½®æ–‡ä»¶æ ¼å¼
   */
  static parseConfigFile(configText) {
    const sectionRegex = /\[(?<section>\w+)\]/g;
    const propertyRegex = /(?<key>\w+)\s*=\s*(?<value>[^\n\r]+)/g;

    const config = {};
    let currentSection = 'default';

    const lines = configText.split(/\r?\n/);

    for (const line of lines) {
      const sectionMatch = sectionRegex.exec(line);
      if (sectionMatch) {
        currentSection = sectionMatch.groups.section;
        config[currentSection] = {};
        sectionRegex.lastIndex = 0; // é‡ç½®regexçŠ¶æ€
        continue;
      }

      const propertyMatch = propertyRegex.exec(line);
      if (propertyMatch) {
        if (!config[currentSection]) {
          config[currentSection] = {};
        }
        config[currentSection][propertyMatch.groups.key] = propertyMatch.groups.value;
        propertyRegex.lastIndex = 0; // é‡ç½®regexçŠ¶æ€
      }
    }

    return config;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const dateText = "é‡è¦æ—¥æœŸ: 2023-12-25 å’Œ 2024-01-01";
console.log('æ—¥æœŸè§£æ:', NamedBackreferences.processComplexPattern(dateText));

const patternText = "test:test valid:valid invalid:notvalid";
console.log('é‡å¤æ¨¡å¼éªŒè¯:', NamedBackreferences.validateRepeatedPattern(patternText));

const configFile = `
[database]
host = localhost
port = 3306
name = mydb

[cache]
type = redis
host = 127.0.0.1
port = 6379
`;
console.log('é…ç½®æ–‡ä»¶è§£æ:', NamedBackreferences.parseConfigFile(configFile));
```

### é€»è¾‘å¤„ç†ï¼ˆLogic Operationsï¼‰

æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„é€»è¾‘å¤„ç†åŒ…æ‹¬åˆ†æ”¯ï¼ˆORæ“ä½œï¼‰ã€æ¡ä»¶åŒ¹é…å’Œå¤æ‚çš„é€»è¾‘ç»„åˆã€‚

```javascript
/**
 * @description æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„é€»è¾‘æ“ä½œ
 */

// | æ“ä½œç¬¦è¡¨ç¤º"æˆ–"(OR)é€»è¾‘
const orPattern = /cat|dog|bird/i;
console.log('I have a cat'.match(orPattern));     // ["cat"]
console.log('I have a dog'.match(orPattern));     // ["dog"]
console.log('I have a fish'.match(orPattern));    // null

// ç»“åˆåˆ†ç»„ä½¿ç”¨æˆ–æ“ä½œ
const groupOrPattern = /(Mr|Mrs|Ms)\.\s+([A-Z][a-z]+)/;
console.log('Mr. Smith'.match(groupOrPattern));   // ["Mr. Smith", "Mr", "Smith"]
console.log('Dr. Johnson'.match(groupOrPattern)); // nullï¼ˆä¸åŒ¹é…Dr.ï¼‰

// å¤æ‚çš„é€»è¾‘ç»„åˆ
const complexLogic = /^(https?:\/\/)?(www\.)?([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,}(\/.*)?$/;
  const urls = [
  'https://www.example.com',
  'http://example.com/path',
  'www.example.com',
  'example.com',
  'ftp://example.com',  // ä¸åŒ¹é…
  'invalid-url'         // ä¸åŒ¹é…
];

console.log('URLéªŒè¯ç»“æœ:');
  urls.forEach(url => {
  console.log(`${url}: ${complexLogic.test(url)}`);
});

/**
 * @description æ¡ä»¶é€»è¾‘å¤„ç†ç±»
 */
class LogicProcessor {
  /**
   * éªŒè¯å¯†ç å¤æ‚æ€§ï¼ˆå¿…é¡»æ»¡è¶³å¤šä¸ªæ¡ä»¶ï¼‰
   */
  static validatePassword(password) {
    const conditions = {
      hasMinLength: password.length >= 8,
      hasLowerCase: /[a-z]/.test(password),
      hasUpperCase: /[A-Z]/.test(password),
      hasDigit: /\d/.test(password),
      hasSpecialChar: /[!@#$%^&*(),.?":{}|<>]/.test(password),
      noRepeatingChars: !/(.)\1{2,}/.test(password), // ä¸å…è®¸3ä¸ªç›¸åŒå­—ç¬¦è¿ç»­
      noCommonPatterns: !/123|abc|password|qwerty/i.test(password)
    };

    const passedConditions = Object.values(conditions).filter(Boolean).length;
    const totalConditions = Object.keys(conditions).length;

      return {
      isValid: passedConditions >= 5, // è‡³å°‘æ»¡è¶³5ä¸ªæ¡ä»¶
      score: Math.round((passedConditions / totalConditions) * 100),
      conditions: conditions,
      strength: this.getPasswordStrength(passedConditions, totalConditions)
    };
  }

  /**
   * è·å–å¯†ç å¼ºåº¦ç­‰çº§
   */
  static getPasswordStrength(passed, total) {
    const ratio = passed / total;
    if (ratio >= 0.9) return 'å¼º';
    if (ratio >= 0.7) return 'ä¸­';
    if (ratio >= 0.5) return 'å¼±';
    return 'å¾ˆå¼±';
  }

  /**
   * å¤šæ¡ä»¶æ–‡ä»¶åéªŒè¯
   */
  static validateFileName(fileName) {
    const rules = {
      hasValidExtension: /\.(jpg|jpeg|png|gif|pdf|doc|docx|txt|zip)$/i.test(fileName),
      hasValidLength: fileName.length >= 1 && fileName.length <= 255,
      noInvalidChars: !/[<>:"/\\|?*]/.test(fileName),
      notReservedName: !/^(con|prn|aux|nul|com[1-9]|lpt[1-9])$/i.test(fileName.split('.')[0]),
      notStartsWithDot: !fileName.startsWith('.'),
      notEndsWithSpace: !fileName.endsWith(' ')
    };

    const issues = [];
    Object.entries(rules).forEach(([rule, passed]) => {
      if (!passed) {
        issues.push(rule);
      }
    });

    return {
      isValid: issues.length === 0,
      issues: issues,
      score: Math.round(((Object.keys(rules).length - issues.length) / Object.keys(rules).length) * 100)
    };
  }

  /**
   * æ™ºèƒ½é‚®ç®±éªŒè¯ï¼ˆæ”¯æŒå¤šç§æ ¼å¼ï¼‰
   */
  static validateEmail(email) {
    // åŸºæœ¬æ ¼å¼éªŒè¯
    const basicFormat = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);

    // æ›´ä¸¥æ ¼çš„éªŒè¯
    const strictFormat = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(email);

    // æ£€æŸ¥å¸¸è§åŸŸå
    const commonDomains = /(gmail|yahoo|hotmail|outlook|qq|163|126)\.com$/i.test(email);

    // æ£€æŸ¥ä¼ä¸šé‚®ç®±æ¨¡å¼
    const corporatePattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.(com|org|net|edu|gov|mil)$/i.test(email);

    // æ£€æŸ¥å¯ç–‘æ¨¡å¼
    const suspiciousPatterns = {
      tooManyDots: (email.match(/\./g) || []).length > 3,
      tooManyHyphens: (email.match(/-/g) || []).length > 2,
      consecutiveSpecialChars: /[._%+-]{2,}/.test(email),
      numbersOnly: /^\d+@/.test(email)
    };

    return {
      isValid: basicFormat && strictFormat,
      basicFormat,
      strictFormat,
      isCommonProvider: commonDomains,
      isCorporate: corporatePattern,
      suspiciousFlags: Object.entries(suspiciousPatterns)
        .filter(([_, flag]) => flag)
        .map(([pattern, _]) => pattern),
      recommendation: this.getEmailRecommendation(basicFormat, strictFormat, commonDomains, suspiciousPatterns)
    };
  }

  /**
   * è·å–é‚®ç®±éªŒè¯å»ºè®®
   */
  static getEmailRecommendation(basic, strict, common, suspicious) {
    if (!basic) return 'é‚®ç®±æ ¼å¼æ— æ•ˆ';
    if (!strict) return 'é‚®ç®±æ ¼å¼ä¸å¤Ÿè§„èŒƒ';
    if (Object.values(suspicious).some(Boolean)) return 'é‚®ç®±åŒ…å«å¯ç–‘æ¨¡å¼';
    if (common) return 'å¸¸è§é‚®ç®±æœåŠ¡å•†ï¼Œå¯ä¿¡åº¦é«˜';
    return 'é‚®ç®±æ ¼å¼æ­£ç¡®';
  }

  /**
   * æ™ºèƒ½æ•°æ®ç±»å‹æ£€æµ‹
   */
  static detectDataType(input) {
    const patterns = {
      integer: /^-?\d+$/,
      float: /^-?\d*\.\d+$/,
      percentage: /^\d+(\.\d+)?%$/,
      currency: /^\$?\d{1,3}(,\d{3})*(\.\d{2})?$/,
      date: /^\d{4}-\d{2}-\d{2}$|^\d{2}\/\d{2}\/\d{4}$|^\d{2}-\d{2}-\d{4}$/,
      time: /^([01]?\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/,
      url: /^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)$/,
      email: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
      phone: /^(\+\d{1,3}[- ]?)?\d{10}$|^\(\d{3}\)\s?\d{3}-\d{4}$/,
      ipAddress: /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,
      hexColor: /^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,
      boolean: /^(true|false|yes|no|1|0)$/i,
      creditCard: /^\d{4}[- ]?\d{4}[- ]?\d{4}[- ]?\d{4}$/
    };

    const matches = {};
    let primaryType = 'string'; // é»˜è®¤ç±»å‹

    Object.entries(patterns).forEach(([type, pattern]) => {
      if (pattern.test(input)) {
        matches[type] = true;
        primaryType = type; // æœ€ååŒ¹é…çš„ç±»å‹ä½œä¸ºä¸»è¦ç±»å‹
      }
    });

    // ç‰¹æ®Šå¤„ç†ï¼šå¦‚æœåŒ¹é…å¤šç§ç±»å‹ï¼Œé€‰æ‹©æœ€å…·ä½“çš„
    if (matches.integer && matches.float) {
      delete matches.integer;
      primaryType = 'float';
    }

    return {
      input,
      primaryType,
      allMatches: Object.keys(matches),
      confidence: Object.keys(matches).length > 0 ? 'high' : 'low',
      suggestions: this.getTypeSuggestions(primaryType, input)
    };
  }

  /**
   * è·å–æ•°æ®ç±»å‹å»ºè®®
   */
  static getTypeSuggestions(type, input) {
    const suggestions = {
      integer: ['å¯ä»¥ç”¨äºè®¡æ•°ã€IDç­‰åœºæ™¯'],
      float: ['é€‚åˆæ•°å€¼è®¡ç®—ã€æµ‹é‡æ•°æ®'],
      percentage: ['å¯ä»¥è½¬æ¢ä¸ºå°æ•°è¿›è¡Œè®¡ç®—'],
      currency: ['æ³¨æ„è´§å¸ç¬¦å·å’Œåƒä½åˆ†éš”ç¬¦'],
      date: ['å»ºè®®ç»Ÿä¸€æ—¥æœŸæ ¼å¼'],
      time: ['å¯ä»¥ç»“åˆæ—¥æœŸä½¿ç”¨'],
      url: ['éªŒè¯URLå¯è®¿é—®æ€§'],
      email: ['è¿›è¡Œé‚®ç®±æ ¼å¼éªŒè¯'],
      phone: ['æ ‡å‡†åŒ–ç”µè¯å·ç æ ¼å¼'],
      ipAddress: ['éªŒè¯IPåœ°å€æœ‰æ•ˆæ€§'],
      hexColor: ['å¯ä»¥è½¬æ¢ä¸ºRGBæ ¼å¼'],
      boolean: ['ç»Ÿä¸€å¸ƒå°”å€¼è¡¨ç¤ºæ–¹å¼'],
      creditCard: ['éœ€è¦è¿›è¡Œæ ¡éªŒä½éªŒè¯']
    };

    return suggestions[type] || ['è¿›ä¸€æ­¥éªŒè¯æ•°æ®æ ¼å¼'];
  }
}

// ä½¿ç”¨ç¤ºä¾‹
console.log('=== å¯†ç éªŒè¯ ===');
const passwords = ['123456', 'Password123!', 'MySecureP@ss2023', 'weakpwd'];
passwords.forEach(pwd => {
  const result = LogicProcessor.validatePassword(pwd);
  console.log(`å¯†ç "${pwd}": ${result.isValid ? 'âœ…' : 'âŒ'} (${result.strength}, ${result.score}åˆ†)`);
});

console.log('\n=== æ–‡ä»¶åéªŒè¯ ===');
const fileNames = ['document.pdf', 'file<name>.txt', 'con.doc', '.hidden', 'normal file.jpg'];
fileNames.forEach(name => {
  const result = LogicProcessor.validateFileName(name);
  console.log(`æ–‡ä»¶å"${name}": ${result.isValid ? 'âœ…' : 'âŒ'} (${result.score}åˆ†)`);
  if (result.issues.length > 0) {
    console.log(`  é—®é¢˜: ${result.issues.join(', ')}`);
  }
});

console.log('\n=== é‚®ç®±éªŒè¯ ===');
const emails = ['user@example.com', 'invalid.email', 'test@gmail.com', '123@company.org'];
emails.forEach(email => {
  const result = LogicProcessor.validateEmail(email);
  console.log(`é‚®ç®±"${email}": ${result.isValid ? 'âœ…' : 'âŒ'} - ${result.recommendation}`);
});

console.log('\n=== æ•°æ®ç±»å‹æ£€æµ‹ ===');
const testData = ['123', '45.67', '89%', '$1,234.56', '2023-12-25', 'user@test.com', '#FF5733'];
testData.forEach(data => {
  const result = LogicProcessor.detectDataType(data);
  console.log(`"${data}" -> ${result.primaryType} (åŒ¹é…: ${result.allMatches.join(', ')})`);
});

/**
 * @description åŠ¨æ€æ­£åˆ™è¡¨è¾¾å¼æ„å»º
 */
class DynamicRegexBuilder {
  /**
   * æ ¹æ®æ¡ä»¶åŠ¨æ€æ„å»ºéªŒè¯è§„åˆ™
   */
  static buildValidationPattern(config) {
    const parts = [];

    // å¼€å§‹é”šç‚¹
    if (config.exactMatch) {
      parts.push('^');
    }

    // é•¿åº¦é™åˆ¶
    if (config.minLength || config.maxLength) {
      const min = config.minLength || 0;
      const max = config.maxLength || '';
      parts.push(`(?=.{${min},${max}})`);
    }

    // å¿…é¡»åŒ…å«çš„å­—ç¬¦ç±»å‹
    if (config.requireLowercase) {
      parts.push('(?=.*[a-z])');
    }
    if (config.requireUppercase) {
      parts.push('(?=.*[A-Z])');
    }
    if (config.requireDigit) {
      parts.push('(?=.*\\d)');
    }
    if (config.requireSpecialChar) {
      parts.push('(?=.*[!@#$%^&*(),.?":{}|<>])');
    }

    // ä¸»è¦æ¨¡å¼
    if (config.allowedChars) {
      parts.push(`[${config.allowedChars}]+`);
    } else {
      parts.push('.+');
    }

    // ç»“æŸé”šç‚¹
    if (config.exactMatch) {
      parts.push('$');
    }

    const pattern = parts.join('');
    const flags = (config.caseInsensitive ? 'i' : '') + (config.global ? 'g' : '');

    return {
      pattern: pattern,
      regex: new RegExp(pattern, flags),
      config: config
    };
  }

  /**
   * æ„å»ºå¤šé€‰ä¸€çš„æ¨¡å¼
   */
  static buildAlternativePattern(options, config = {}) {
    const escapedOptions = options.map(opt =>
      opt.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')
    );

    const pattern = config.exactMatch
      ? `^(${escapedOptions.join('|')})$`
      : `(${escapedOptions.join('|')})`;

    const flags = (config.caseInsensitive ? 'i' : '') + (config.global ? 'g' : '');

    return {
      pattern: pattern,
      regex: new RegExp(pattern, flags),
      options: options
    };
  }

  /**
   * æ„å»ºæ¡ä»¶æ¨¡å¼ï¼ˆå¦‚æœ...åˆ™...ï¼‰
   */
  static buildConditionalPattern(conditions) {
    const patterns = conditions.map(condition => {
      if (condition.if && condition.then) {
        return `(?:(?=${condition.if})${condition.then})`;
      }
      return condition.pattern || '';
    }).filter(Boolean);

    return {
      pattern: patterns.join('|'),
      regex: new RegExp(patterns.join('|')),
      conditions: conditions
    };
  }
}

// ä½¿ç”¨ç¤ºä¾‹
console.log('\n=== åŠ¨æ€æ­£åˆ™æ„å»º ===');

// æ„å»ºå¯†ç éªŒè¯è§„åˆ™
const passwordConfig = {
  exactMatch: true,
  minLength: 8,
  maxLength: 20,
  requireLowercase: true,
  requireUppercase: true,
  requireDigit: true,
  requireSpecialChar: true,
  allowedChars: 'A-Za-z0-9!@#$%^&*'
};

const passwordPattern = DynamicRegexBuilder.buildValidationPattern(passwordConfig);
console.log('åŠ¨æ€å¯†ç éªŒè¯:', passwordPattern.pattern);
console.log('æµ‹è¯•ç»“æœ:', passwordPattern.regex.test('MyPassword123!'));

// æ„å»ºæ–‡ä»¶ç±»å‹éªŒè¯
const fileTypePattern = DynamicRegexBuilder.buildAlternativePattern(
  ['jpg', 'jpeg', 'png', 'gif', 'pdf'],
  { exactMatch: false, caseInsensitive: true }
);
console.log('æ–‡ä»¶ç±»å‹éªŒè¯:', fileTypePattern.pattern);
console.log('æµ‹è¯•ç»“æœ:', 'image.JPG'.match(fileTypePattern.regex));
```
